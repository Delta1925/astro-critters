import e from"fast-glob";import n from"fs";import{deepmerge as p}from"deepmerge-ts";import c from"critters";const f=async r=>{const s=new c(r);await l(`${r.path}**/*.html`,async t=>await s.process(t))},l=async(r,s=async o=>o,t=async o=>await n.promises.readFile(o,"utf-8"))=>{const o=await e(r);for(const i of o)try{const a=await s(await t(i));if(!a)continue;await n.promises.writeFile(i,a,"utf-8")}catch{console.log("Error: Cannot inline file "+i+" CSS!")}};function m(r={}){var o;const t=p({path:"./dist/",preload:"swap-high",inlineFonts:!0,compress:!0},r);return t.path=(o=t.path)!=null&&o.endsWith("/")?t.path:`${t.path}/`,{name:"astro-critters",hooks:{"astro:config:done":async i=>{t.path=t.path?t.path:i.config.outDir.toString()},"astro:build:done":async()=>{await f(t)}}}}export{m as default};
